


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Auquan Toolbox is the best opensource tool for institutional investors to test their trading strategies with. Built by some of the worlds leading quants, so you can focus on delivering alpha.">
      
      
        <link rel="canonical" href="httos://toolbox.auquan.com/">
      
      
        <meta name="author" content="Auquan">
      
      <link rel="shortcut icon" href="auquan.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.0">
    
    
      
        <title>First Steps - Auquantoolbox Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.b5d04df8.min.css">
      
        <link rel="stylesheet" href="assets/stylesheets/palette.9ab2c1f8.min.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Questrial:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Questrial",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welcome-to-auquan-toolbox" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="httos://toolbox.auquan.com" title="Auquantoolbox Documentation" class="md-header-nav__button md-logo" aria-label="Auquantoolbox Documentation">
      
  <img src="toolbox.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Auquantoolbox Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              First Steps
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/auquan/auquantoolbox" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    auquan/auquantoolbox
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="." class="md-tabs__link md-tabs__link--active">
          Getting Started
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="advanced/under-the-hood/" class="md-tabs__link">
          Advanced
        </a>
      
    </li>
  

      
        
      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="httos://toolbox.auquan.com" title="Auquantoolbox Documentation" class="md-nav__button md-logo" aria-label="Auquantoolbox Documentation">
      
  <img src="toolbox.png" alt="logo">

    </a>
    Auquantoolbox Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/auquan/auquantoolbox" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    auquan/auquantoolbox
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        First Steps
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="." title="First Steps" class="md-nav__link md-nav__link--active">
      First Steps
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#demo-video" class="md-nav__link">
    Demo Video
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-guide" class="md-nav__link">
    Installation Guide
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-does-the-toolbox-work" class="md-nav__link">
    How does the toolbox work?
  </a>
  
    <nav class="md-nav" aria-label="How does the toolbox work?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-setup" class="md-nav__link">
    Quick Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data-datasource" class="md-nav__link">
    Getting Data - DataSource
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-features-instrument-market-and-custom-features" class="md-nav__link">
    Specifying Features - Instrument, Market and Custom Features
  </a>
  
    <nav class="md-nav" aria-label="Specifying Features - Instrument, Market and Custom Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-features-optional" class="md-nav__link">
    Custom Features - Optional
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prediction-function" class="md-nav__link">
    Prediction Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-metrics" class="md-nav__link">
    Final Metrics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importing-a-trained-model" class="md-nav__link">
    Importing a trained model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="getting-started/" title="How it works" class="md-nav__link">
      How it works
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="prebuilt-feature-guide/" title="Prebuilt Feature Guide" class="md-nav__link">
      Prebuilt Feature Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Advanced
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Advanced" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="advanced/under-the-hood/" title="Under The Hood" class="md-nav__link">
      Under The Hood
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="advanced/ml-system/" title="Machine Learning System" class="md-nav__link">
      Machine Learning System
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="prebuilt-feature-guide/" title="Feature Guide" class="md-nav__link">
      Feature Guide
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#demo-video" class="md-nav__link">
    Demo Video
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-guide" class="md-nav__link">
    Installation Guide
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-does-the-toolbox-work" class="md-nav__link">
    How does the toolbox work?
  </a>
  
    <nav class="md-nav" aria-label="How does the toolbox work?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-setup" class="md-nav__link">
    Quick Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data-datasource" class="md-nav__link">
    Getting Data - DataSource
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-features-instrument-market-and-custom-features" class="md-nav__link">
    Specifying Features - Instrument, Market and Custom Features
  </a>
  
    <nav class="md-nav" aria-label="Specifying Features - Instrument, Market and Custom Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-features-optional" class="md-nav__link">
    Custom Features - Optional
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prediction-function" class="md-nav__link">
    Prediction Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-metrics" class="md-nav__link">
    Final Metrics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importing-a-trained-model" class="md-nav__link">
    Importing a trained model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <p><strong>Note</strong>: This the documentation for the current version toolbox released by Auquan. The old, stripped down version (installed as auquanToolbox, has been deprecated). <a href="https://links.auquan.com/auquantoolbox">You can see the current toolbox repository here</a> - if you face any bugs, please open an issue on the github repository or email us at: toolbox@auquan.com</p>
<h1 id="welcome-to-auquan-toolbox">Welcome to Auquan Toolbox</h1>
<p><a href="http://www.auquan.com">Auquan</a> provides a backtesting toolbox to develop your trading algorithms. The toolbox is free and open source which you can use to create and backtest strategies.</p>
<h2 id="demo-video">Demo Video</h2>
<p>You can watch a <a href="(https://www.youtube.com/watch?v=YHdb8w3oRw0)">quick video demo</a> for the toolbox below</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/YHdb8w3oRw0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2 id="installation-guide">Installation Guide</h2>
<ol>
<li>
<p>Install Python and dependent packages<br />
Our toolbox is compatible with both Python 2.7( there are currently some issues with Python 3, we'll fix them shortly). The easiest way to install Python is through Anaconda since it will reliably install all the necessary dependencies. Download <a href="http://continuum.io/downloads">Anaconda</a> and follow the instructions on the <a href="http://docs.continuum.io/anaconda/install">installation page</a>.   Once you have Python, you can then install the toolbox.</p>
</li>
<li>
<p>Get the Auquan Toolbox
    There are multiple ways to install the toolbox for the competition.</p>
<ul>
<li><strong>Via pip</strong>: The easiest way and the most recommended way is via pip. Just run the following command: <code>pip install -U auquan_toolbox</code>. If we publish any updates to the toolbox, the same command <code>pip install -U auquan_toolbox</code> will also automatically get the new version of the toolbox. <strong>Note: Mac users</strong>, if you face any issues with installation, try using <code>pip install --user auquan_toolbox</code>  </li>
<li>
<p><strong>Via git</strong>: Clone/Download this repository.</p>
<p><code> git clone https://github.com/Auquan/auquantoolbox.git </code></p>
</li>
</ul>
</li>
<li>
<p>Read the Getting Started Guide Above
    This guide explains the basics about how the toolbox works in a little more detail than here. <a href="https://auquan.toolbox.com/getting-started">It can also be accessed here</a></p>
</li>
<li>
<p>Download <a href="https://links.auquan.com/sampleParams">this sample file</a> and navigate to the place where you downloaded it (if you cloned the repo, the file is already present). Go inside that folder and run the following code to make sure everything is setup properly.</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">my_trading_params</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>


</li>
<li>
<p>Use <em>my_trading_params.py</em> as a template which contains skeleton functions (with explanation) that need to be filled in to create your own trading strategy. Copy that template to another file and then start implementing the methods in that file. You can use <em>pair_trading_params.py</em> and <em>meanreversion_trading_params.py</em> as motivation.</p>
</li>
</ol>
<h2 id="how-does-the-toolbox-work">How does the toolbox work?</h2>
<p>Any security you want to trade with the toolbox is called an <em>instrument</em>. Right now, the toolbox supports stock and future instruments. All the parameters for the toolbox are supplied in class <code>MyTradingParams()</code>.
<br><br></p>
<h3 id="quick-setup">Quick Setup</h3>
<p>To get started quickly with the toolbox, you need to</p>
<ol>
<li>Get Historical Data</li>
<li>Specify Features to be created from the Data</li>
<li>Create a prediction function using above features to make your prediction for the market</li>
</ol>
<p>The toolbox can handle everything else for you. You can do the above by modifying the following functions:
<br><br></p>
<h3 id="getting-data-datasource">Getting Data - DataSource</h3>
<p>Data Source parses data from external sources (csv, log file, html file etc) and loads and converts it into a toolbox compatible form. You need to specify the instrumentID's that you need data for and start and end date for data in in <code>getDataParser()</code> function.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">getDataParser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">instrumentIds</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IBM&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">]</span>
        <span class="n">startDateStr</span> <span class="o">=</span> <span class="s1">&#39;2017/05/10&#39;</span>
        <span class="n">endDateStr</span> <span class="o">=</span> <span class="s1">&#39;2017/06/09&#39;</span>
        <span class="k">return</span> <span class="n">YahooStockDataSource</span><span class="p">(</span><span class="n">cachedFolderName</span><span class="o">=</span><span class="s1">&#39;yahooData&#39;</span><span class="p">,</span>
                                     <span class="n">instrumentIds</span><span class="o">=</span><span class="n">instrumentIds</span><span class="p">,</span>
                                     <span class="n">startDateStr</span><span class="o">=</span><span class="n">startDateStr</span><span class="p">,</span>
                                     <span class="n">endDateStr</span><span class="o">=</span><span class="n">endDateStr</span><span class="p">)</span>
</code></pre></div>


<p>Current choices for datasource are:
* <a href="https://links.auquan.com/yahooDataSource">YahooStockDataSource</a> - Stock data from Yahoo (daily data)
* <a href="https://links.auquan.com/nseDataSource">NSEStockDataSource</a> - Stock data from NSE (daily data)
* AuquanDataSource - Data from US stock database of 500 biggest stocks maintained by Auquan.
<br><br></p>
<h3 id="specifying-features-instrument-market-and-custom-features">Specifying Features - Instrument, Market and Custom Features</h3>
<p>You can manipulate historical data by creating features. Features are called by specifying config dictionaries. You have to:</p>
<ol>
<li>
<p>Create one config dictionary per feature.</p>
<p><strong>Feature config Dictionary has the following keys:</strong></p>
<blockquote>
<p><em>featureId:</em> string representing the feature you want to use<br />
<em>featureKey:</em> {optional} string representing key to access value of this feature. If not present, use featureId<br />
<em>params:</em> {optional} A dictionary with which contains other parameters, if needed by the feature  </p>
</blockquote>
</li>
<li>
<p>Return an array of all feature config dictionaries as market features or instrument features. Specify the instrument features in function <code>getInstrumentFeatureConfigDicts()</code> and market features in function <code>getMarketFeatureConfigDicts()</code>. Instrument features are calculated per instrument (for example position, fees, moving average of instrument price). The toolbox auto-loops through all instruments to calculate features for you. Market features are calculated for whole trading system (for example portfolio value).</p>
<p><strong>Example</strong>: If you want to use the moving_sum feature and calculate this for all instruments, your <em><code>getInstrumentFeatureConfigDicts()</code></em> function should be:</p>
</li>
</ol>
<div class="codehilite"><pre><span></span><code>  <span class="k">def</span> <span class="nf">getInstrumentFeatureConfigDicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">msDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;featureKey&#39;</span><span class="p">:</span> <span class="s1">&#39;ms_5&#39;</span><span class="p">,</span>
                <span class="s1">&#39;featureId&#39;</span><span class="p">:</span> <span class="s1">&#39;moving_sum&#39;</span><span class="p">,</span>
                <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;featureName&#39;</span><span class="p">:</span> <span class="s1">&#39;basis&#39;</span><span class="p">}}</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">msDict</span><span class="p">]</span>
</code></pre></div>


<p>You can now use this feature by calling it's featureKey, 'ms_5'.    <br />
Full list of features with featureId and params is available <a href="#">here</a>.</p>
<h4 id="custom-features-optional">Custom Features - Optional</h4>
<p>To use your own custom features, you need to create them separately. Follow the example of <a href="https://links.auquan.com/customFeature">this template</a>. Specifically, you'll have to:</p>
<ul>
<li>Create a new class for the feature and implement your logic. You can copy the template from <a href="https://links.auquan.com/customFeature">this file</a>.
    Example: If you were implementing a new InstrumentFeature</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomFeatureClassName</span><span class="p">(</span><span class="n">Feature</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">computeForInstrument</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">featureParams</span><span class="p">,</span> <span class="n">featureKey</span><span class="p">,</span> <span class="n">currentFeatures</span><span class="p">,</span> <span class="n">instrument</span><span class="p">,</span> <span class="n">instrumentManager</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">5</span>
</code></pre></div>


<ul>
<li>
<p>Modify function <code>getCustomFeatures()</code> to return a dictionary with   </p>
<blockquote>
<p><em>key:</em> featureId to access this feature (Make sure this doesn't conflict with any of the pre defined feature Ids)<br />
<em>value:</em> Your custom Class Name which computes this feature. The class should be an instance of Feature</p>
</blockquote>
<p>Eg. to use the feature we create above via featureId='my_custom_feature_identifier',  </p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">getCustomFeatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;my_custom_feature_identifier&#39;</span><span class="p">:</span> <span class="n">MyCustomFeatureClassName</span><span class="p">}</span>
</code></pre></div>


<ul>
<li>Now you can create a dict for this feature in <code>getInstrumentFeatureConfigDicts()</code>. Dict format is:</li>
</ul>
<div class="codehilite"><pre><span></span><code>  <span class="n">customFeatureDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;featureKey&#39;</span><span class="p">:</span> <span class="s1">&#39;my_custom_feature_key&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;featureId&#39;</span><span class="p">:</span> <span class="s1">&#39;my_custom_feature_identifier&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;param1&#39;</span><span class="p">:</span> <span class="s1">&#39;value1&#39;</span><span class="p">}}</span>
</code></pre></div>


<p>Use this feature by calling it's featureKey, 'my_custom_feature_key'</p>
<p><br><br></p>
<h3 id="prediction-function">Prediction Function</h3>
<p>Combine all the features to create the desired prediction function. Fill the funtion <code>getPrediction()</code> to return the prediction for instrument you are trading.</p>
<p>Here you can call your previously created features by referencing their featureId. For example, I can call my moving sum and custom feature as:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">getPrediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">currentMarketFeatures</span><span class="p">,</span> <span class="n">instrumentManager</span><span class="p">):</span>

        <span class="c1"># holder for all the instrument features</span>
        <span class="n">lookbackInstrumentFeatures</span> <span class="o">=</span> <span class="n">instrumentManager</span><span class="o">.</span><span class="n">getLookbackInstrumentFeatures</span><span class="p">()</span>

        <span class="n">ms5Data</span> <span class="o">=</span> <span class="n">lookbackInstrumentFeatures</span><span class="o">.</span><span class="n">getFeatureDf</span><span class="p">(</span><span class="s1">&#39;ms_5&#39;</span><span class="p">)</span>
        <span class="c1"># dataframe for a historical instrument feature (ms_5 in this case).   </span>
        <span class="c1"># The index is the timestamps of atmost lookback data points.</span>
        <span class="c1"># The last row of this data frame would contain the features</span>
        <span class="c1"># which are being calculated in this update cycle or for this time.</span>
        <span class="c1"># The second to last row (if exists) would have the features for the previous</span>
        <span class="c1"># time update.</span>
        <span class="c1"># The columns of this dataframe are the stock symbols/instrumentIds.</span>

        <span class="n">ms5</span> <span class="o">=</span> <span class="n">ms5Data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># This returns the value of the feature at the last time update</span>
        <span class="c1"># Returns a series with index as all the instrumentIds.</span>

        <span class="n">customData</span> <span class="o">=</span> <span class="n">lookbackInstrumentFeatures</span><span class="o">.</span><span class="n">getFeatureDf</span><span class="p">(</span><span class="s1">&#39;my_custom_feature_key&#39;</span><span class="p">)</span>
        <span class="n">custom</span> <span class="o">=</span> <span class="n">customData</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">ms5</span> <span class="o">/</span> <span class="n">custom</span>
        <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div>


<p>Predictions can be of many types. You can calculate(predict) the <em>FairValue</em> of a parameter, for example price. You can predict the probability that price will increase in the future. You can predict the ratio of price of two securities. You can predict the ranking of a basket of securities. Output of the prediction function is used by the toolbox to make further trading decisions via the <a href="https://toolbox.auquan.com/advanced/under-the-hood">execution system</a>. Choice of execution system depends on the type of prediction made.</p>
<p><br><br></p>
<h3 id="final-metrics">Final Metrics</h3>
<p>The system returns the following final metrics:</p>
<ol>
<li><em>Total PnL:</em> Total Profit(or Loss) from your strategy as a % of initial capital</li>
<li><em>Annualized Return:</em> The yearly average % Profit(or Loss) from your trading strategy</li>
<li><em>Annualized Volatility:</em> The standard deviation of daily returns of the model in a year. Volatility is used as a measure of risk, therefore higher vol implies riskier model.</li>
<li><em>Sharpe Ratio:</em> The reward/risk ratio or risk adjusted returns of the strategy, calculated as Annualized Return/Annualized Volatility</li>
<li><em>Sortino Ratio:</em> Returns adjusted for downside risk, calculated as Annualized Return/Annualized Volatility of Negative Returns</li>
<li><em>Max Drawdown:</em> Largest drop in Pnl or maximum negative difference in total portfolio value. It is calculated as the maximum high to subsequent low difference before a new high is reached.</li>
<li><em>Win/Loss, Average Profit/Loss:</em> Sum(or Avergae) of Profits from trades that results in profits/Sum(or Average) of losses from trades that results in losses</li>
<li><em>% Profitability</em> = % of total trades that resulted in profits</li>
<li><em>Return on Capital</em> = Total Profit(or Loss) from your strategy as a % of max capital used</li>
</ol>
<p>Other Metrics can be supported if needed.</p>
<p><br><br></p>
<h3 id="importing-a-trained-model">Importing a trained model</h3>
<p>If you would like to write your own custom datasource/execution system or you want to import a pre-trained ML model, you can do so in the manner below.
Here we store a file <code>training_execution_system.py</code> on github. Then we specify the path to file, and the code downloads the file as <code>fileName</code> and imports the required class from it.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">urllib</span>

<span class="n">path_to_file</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/Auquan/quant-quest-2/master/training_execution_system.py&#39;</span>
<span class="n">fileName</span> <span class="o">=</span> <span class="s1">&#39;training_execution_system.py&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fileName</span><span class="p">):</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span> <span class="p">(</span><span class="n">path_to_file</span><span class="p">,</span> <span class="n">fileName</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">training_execution_system</span> <span class="kn">import</span> <span class="n">TrainingExecutionSystem</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="." title="Home" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </div>
            </div>
          </a>
        
        
          <a href="getting-started/" title="How it works" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                How it works
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 - 2020 Auquan
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/auquan" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/auquan_" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/auquan/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: ["tabs"],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>